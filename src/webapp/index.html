<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SignalK Edge Link Configuration</title>
    <link rel="icon" type="image/png" href="/plugins/signalk-edge-link/icon.png">
</head>
<body>
    <div id="app">
        <header class="header">
            <h1>SignalK Edge Link Configuration</h1>
            <p class="subtitle">Configure delta timer and subscription settings</p>
        </header>

        <div class="container">
            <div class="config-section">
                <div class="card">
                    <div class="card-header">
                        <h2>Delta Timer Configuration</h2>
                        <p>Controls how often deltas are collected and sent (in milliseconds)</p>
                    </div>
                    <div class="card-content">
                        <div class="form-group">
                            <label for="deltaTimer">Delta Timer (ms):</label>
                            <input 
                                type="number" 
                                id="deltaTimer" 
                                min="100" 
                                max="10000" 
                                step="100"
                                placeholder="1000"
                            />
                            <small class="help-text">
                                Lower values = more frequent updates, higher bandwidth usage<br>
                                Higher values = better compression ratio, lower bandwidth usage
                            </small>
                        </div>
                        <button id="saveDeltaTimer" class="btn btn-primary">Save Delta Timer</button>
                    </div>
                </div>
            </div>

            <div class="config-section">
                <div class="card">
                    <div class="card-header">
                        <h2>Subscription Configuration</h2>
                        <p>Define which SignalK data paths to subscribe to</p>
                    </div>
                    <div class="card-content">
                        <div class="form-group">
                            <label for="context">Context:</label>
                            <input type="text" id="context" placeholder="*" />
                            <small class="help-text">
                                Context for the subscription (e.g., "vessels.self", "*" for all)
                            </small>
                        </div>

                        <div class="subscription-paths">
                            <h3>Subscription Paths</h3>
                            <div id="pathsList" class="paths-list"></div>
                            <button id="addPath" class="btn btn-secondary">Add Path</button>
                        </div>

                        <div class="json-editor">
                            <h3>JSON Editor</h3>
                            <textarea id="subscriptionJson" rows="10" placeholder='{"context": "*", "subscribe": [{"path": "*"}]}'></textarea>
                            <small class="help-text">
                                Advanced: Edit the raw JSON configuration
                            </small>
                        </div>

                        <button id="saveSubscription" class="btn btn-primary">Save Subscription</button>
                    </div>
                </div>
            </div>

            <div class="config-section">
                <div class="card">
                    <div class="card-header">
                        <h2>Sentence Filter</h2>
                        <p>Exclude NMEA sentences from transmission (reduces bandwidth)</p>
                    </div>
                    <div class="card-content">
                        <div class="form-group">
                            <label for="sentenceFilter">Excluded Sentences:</label>
                            <input
                                type="text"
                                id="sentenceFilter"
                                placeholder="GSV, GSA, VTG"
                            />
                            <small class="help-text">
                                Comma-separated list of NMEA sentence types to exclude (e.g., GSV, GSA, VTG)<br>
                                Common sentences: GSV (satellites in view), GSA (DOP and active satellites), VTG (track/speed)
                            </small>
                        </div>
                        <button id="saveSentenceFilter" class="btn btn-primary">Save Sentence Filter</button>
                    </div>
                </div>
            </div>

            <div class="config-section">
                <div class="card">
                    <div class="card-header">
                        <h2>Status</h2>
                    </div>
                    <div class="card-content">
                        <div id="status" class="status-info">
                            <p>Loading configuration...</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="config-section">
                <div class="card">
                    <div class="card-header">
                        <h2>Network Quality</h2>
                        <p class="subtitle">Link quality score and network health indicators</p>
                    </div>
                    <div class="card-content">
                        <div id="networkQuality" class="network-quality-info">
                            <p>Loading network quality data...</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="config-section">
                <div class="card">
                    <div class="card-header">
                        <h2>Bandwidth Monitor</h2>
                        <p class="subtitle">Real-time data transmission statistics</p>
                    </div>
                    <div class="card-content">
                        <div id="bandwidth" class="bandwidth-info">
                            <p>Loading bandwidth data...</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="config-section">
                <div class="card">
                    <div class="card-header">
                        <h2>Path Analytics</h2>
                        <p class="subtitle">Data volume by subscription path</p>
                    </div>
                    <div class="card-content">
                        <div id="pathAnalytics" class="path-analytics-info">
                            <p>Loading path analytics...</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="config-section">
                <div class="card">
                    <div class="card-header">
                        <h2>Performance Metrics</h2>
                        <p class="subtitle">Real-time transmission statistics (auto-refreshes every 15 seconds)</p>
                    </div>
                    <div class="card-content">
                        <div id="metrics" class="metrics-info">
                            <p>Loading metrics...</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="congestionSection" class="config-section" style="display:none;">
                <div class="card">
                    <div class="card-header">
                        <h2>Congestion Control</h2>
                        <p class="subtitle">AIMD congestion control state and delta timer auto-adjustment</p>
                    </div>
                    <div class="card-content">
                        <div id="congestionControl" class="congestion-info">
                            <p>Loading congestion control data...</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="bondingSection" class="config-section" style="display:none;">
                <div class="card">
                    <div class="card-header">
                        <h2>Connection Bonding</h2>
                        <p class="subtitle">Multi-link bonding status and failover control</p>
                    </div>
                    <div class="card-content">
                        <div id="bondingStatus" class="bonding-info">
                            <p>Loading bonding status...</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="monitoringSection" class="config-section" style="display:none;">
                <div class="card">
                    <div class="card-header">
                        <h2>Monitoring &amp; Alerts</h2>
                        <p class="subtitle">Packet loss, retransmission tracking, and alert thresholds</p>
                    </div>
                    <div class="card-content">
                        <div id="monitoringAlerts" class="monitoring-info">
                            <p>Loading monitoring data...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="notification" class="notification"></div>
</body>
</html>