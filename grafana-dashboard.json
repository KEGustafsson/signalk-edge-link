{
  "__inputs": [
    {
      "name": "DS_PROMETHEUS",
      "label": "Prometheus",
      "description": "Prometheus data source for Signal K Edge Link metrics",
      "type": "datasource",
      "pluginId": "prometheus",
      "pluginName": "Prometheus"
    }
  ],
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": "-- Grafana --",
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "description": "Signal K Edge Link v2.0 - Network monitoring dashboard",
  "editable": true,
  "gnetId": null,
  "graphTooltip": 1,
  "id": null,
  "links": [],
  "panels": [
    {
      "title": "Overview",
      "type": "row",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 0 },
      "collapsed": false,
      "panels": []
    },
    {
      "title": "Link Quality Score",
      "type": "gauge",
      "datasource": "${DS_PROMETHEUS}",
      "gridPos": { "h": 6, "w": 4, "x": 0, "y": 1 },
      "targets": [
        {
          "expr": "signalk_edge_link_link_quality_score",
          "legendFormat": "Quality"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "min": 0,
          "max": 100,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "red", "value": null },
              { "color": "orange", "value": 50 },
              { "color": "yellow", "value": 70 },
              { "color": "green", "value": 85 }
            ]
          },
          "unit": "none"
        }
      }
    },
    {
      "title": "RTT (ms)",
      "type": "stat",
      "datasource": "${DS_PROMETHEUS}",
      "gridPos": { "h": 6, "w": 4, "x": 4, "y": 1 },
      "targets": [
        {
          "expr": "signalk_edge_link_rtt_milliseconds",
          "legendFormat": "RTT"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "ms",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "yellow", "value": 200 },
              { "color": "orange", "value": 500 },
              { "color": "red", "value": 1000 }
            ]
          }
        }
      }
    },
    {
      "title": "Jitter (ms)",
      "type": "stat",
      "datasource": "${DS_PROMETHEUS}",
      "gridPos": { "h": 6, "w": 4, "x": 8, "y": 1 },
      "targets": [
        {
          "expr": "signalk_edge_link_jitter_milliseconds",
          "legendFormat": "Jitter"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "ms",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "yellow", "value": 50 },
              { "color": "orange", "value": 100 },
              { "color": "red", "value": 300 }
            ]
          }
        }
      }
    },
    {
      "title": "Packet Loss",
      "type": "stat",
      "datasource": "${DS_PROMETHEUS}",
      "gridPos": { "h": 6, "w": 4, "x": 12, "y": 1 },
      "targets": [
        {
          "expr": "signalk_edge_link_packet_loss_rate",
          "legendFormat": "Loss"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "percentunit",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "yellow", "value": 0.01 },
              { "color": "orange", "value": 0.05 },
              { "color": "red", "value": 0.10 }
            ]
          }
        }
      }
    },
    {
      "title": "Uptime",
      "type": "stat",
      "datasource": "${DS_PROMETHEUS}",
      "gridPos": { "h": 6, "w": 4, "x": 16, "y": 1 },
      "targets": [
        {
          "expr": "signalk_edge_link_uptime_seconds",
          "legendFormat": "Uptime"
        }
      ],
      "fieldConfig": {
        "defaults": { "unit": "s" }
      }
    },
    {
      "title": "Queue Depth",
      "type": "stat",
      "datasource": "${DS_PROMETHEUS}",
      "gridPos": { "h": 6, "w": 4, "x": 20, "y": 1 },
      "targets": [
        {
          "expr": "signalk_edge_link_queue_depth",
          "legendFormat": "Queue"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "yellow", "value": 50 },
              { "color": "red", "value": 200 }
            ]
          }
        }
      }
    },
    {
      "title": "Network Quality",
      "type": "row",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 7 },
      "collapsed": false,
      "panels": []
    },
    {
      "title": "RTT & Jitter Over Time",
      "type": "timeseries",
      "datasource": "${DS_PROMETHEUS}",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 8 },
      "targets": [
        {
          "expr": "signalk_edge_link_rtt_milliseconds",
          "legendFormat": "RTT"
        },
        {
          "expr": "signalk_edge_link_jitter_milliseconds",
          "legendFormat": "Jitter"
        }
      ],
      "fieldConfig": {
        "defaults": { "unit": "ms" }
      },
      "options": {
        "legend": { "displayMode": "list", "placement": "bottom" },
        "tooltip": { "mode": "multi" }
      }
    },
    {
      "title": "Packet Loss & Retransmission Rate",
      "type": "timeseries",
      "datasource": "${DS_PROMETHEUS}",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 8 },
      "targets": [
        {
          "expr": "signalk_edge_link_packet_loss_rate",
          "legendFormat": "Packet Loss"
        },
        {
          "expr": "signalk_edge_link_retransmit_rate",
          "legendFormat": "Retransmit Rate"
        }
      ],
      "fieldConfig": {
        "defaults": { "unit": "percentunit" }
      },
      "options": {
        "legend": { "displayMode": "list", "placement": "bottom" }
      }
    },
    {
      "title": "Bandwidth",
      "type": "row",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 16 },
      "collapsed": false,
      "panels": []
    },
    {
      "title": "Bandwidth (bytes/s)",
      "type": "timeseries",
      "datasource": "${DS_PROMETHEUS}",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 17 },
      "targets": [
        {
          "expr": "signalk_edge_link_bandwidth_rate_out_bytes",
          "legendFormat": "Upload"
        },
        {
          "expr": "signalk_edge_link_bandwidth_rate_in_bytes",
          "legendFormat": "Download"
        }
      ],
      "fieldConfig": {
        "defaults": { "unit": "Bps" }
      }
    },
    {
      "title": "Compression Ratio",
      "type": "timeseries",
      "datasource": "${DS_PROMETHEUS}",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 17 },
      "targets": [
        {
          "expr": "signalk_edge_link_compression_ratio_percent",
          "legendFormat": "Compression %"
        }
      ],
      "fieldConfig": {
        "defaults": { "unit": "percent", "min": 0, "max": 100 }
      }
    },
    {
      "title": "Packets & Deltas",
      "type": "row",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 25 },
      "collapsed": false,
      "panels": []
    },
    {
      "title": "Packets Rate",
      "type": "timeseries",
      "datasource": "${DS_PROMETHEUS}",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 26 },
      "targets": [
        {
          "expr": "rate(signalk_edge_link_packets_out_total[5m])",
          "legendFormat": "Packets Out/s"
        },
        {
          "expr": "rate(signalk_edge_link_packets_in_total[5m])",
          "legendFormat": "Packets In/s"
        }
      ],
      "fieldConfig": {
        "defaults": { "unit": "pps" }
      }
    },
    {
      "title": "Retransmissions",
      "type": "timeseries",
      "datasource": "${DS_PROMETHEUS}",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 26 },
      "targets": [
        {
          "expr": "rate(signalk_edge_link_retransmissions_total[5m])",
          "legendFormat": "Retransmissions/s"
        }
      ],
      "fieldConfig": {
        "defaults": { "unit": "short" }
      }
    },
    {
      "title": "Connection Bonding",
      "type": "row",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 34 },
      "collapsed": true,
      "panels": [
        {
          "title": "Active Link",
          "type": "stat",
          "datasource": "${DS_PROMETHEUS}",
          "gridPos": { "h": 6, "w": 6, "x": 0, "y": 35 },
          "targets": [
            {
              "expr": "signalk_edge_link_bonding_active_link",
              "legendFormat": "Active Link"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "mappings": [
                { "type": "value", "options": { "1": { "text": "Primary" }, "2": { "text": "Backup" } } }
              ]
            }
          }
        },
        {
          "title": "Per-Link RTT",
          "type": "timeseries",
          "datasource": "${DS_PROMETHEUS}",
          "gridPos": { "h": 6, "w": 9, "x": 6, "y": 35 },
          "targets": [
            {
              "expr": "signalk_edge_link_bonding_link_rtt_milliseconds{link=\"primary\"}",
              "legendFormat": "Primary RTT"
            },
            {
              "expr": "signalk_edge_link_bonding_link_rtt_milliseconds{link=\"backup\"}",
              "legendFormat": "Backup RTT"
            }
          ],
          "fieldConfig": {
            "defaults": { "unit": "ms" }
          }
        },
        {
          "title": "Per-Link Quality",
          "type": "timeseries",
          "datasource": "${DS_PROMETHEUS}",
          "gridPos": { "h": 6, "w": 9, "x": 15, "y": 35 },
          "targets": [
            {
              "expr": "signalk_edge_link_bonding_link_quality{link=\"primary\"}",
              "legendFormat": "Primary Quality"
            },
            {
              "expr": "signalk_edge_link_bonding_link_quality{link=\"backup\"}",
              "legendFormat": "Backup Quality"
            }
          ],
          "fieldConfig": {
            "defaults": { "min": 0, "max": 100 }
          }
        }
      ]
    },
    {
      "title": "Errors",
      "type": "row",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 41 },
      "collapsed": true,
      "panels": [
        {
          "title": "Error Rates",
          "type": "timeseries",
          "datasource": "${DS_PROMETHEUS}",
          "gridPos": { "h": 8, "w": 24, "x": 0, "y": 42 },
          "targets": [
            {
              "expr": "rate(signalk_edge_link_udp_send_errors_total[5m])",
              "legendFormat": "UDP Errors/s"
            },
            {
              "expr": "rate(signalk_edge_link_compression_errors_total[5m])",
              "legendFormat": "Compression Errors/s"
            },
            {
              "expr": "rate(signalk_edge_link_encryption_errors_total[5m])",
              "legendFormat": "Encryption Errors/s"
            }
          ]
        }
      ]
    }
  ],
  "refresh": "10s",
  "schemaVersion": 30,
  "style": "dark",
  "tags": ["signalk", "edge-link", "networking", "udp"],
  "templating": { "list": [] },
  "time": { "from": "now-1h", "to": "now" },
  "timepicker": {},
  "timezone": "browser",
  "title": "Signal K Edge Link v2.0",
  "uid": "signalk-edge-link-v2",
  "version": 1
}
