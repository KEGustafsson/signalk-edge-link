"use strict";(self.webpackChunksignalk_edge_link=self.webpackChunksignalk_edge_link||[]).push([[48],{48(e,n,t){t.r(n),t.d(n,{default:()=>b});var a=t(403),r=t.n(a);function i(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var a,r,i,l,o=[],s=!0,c=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;s=!1}else for(;!(s=(a=i.call(t)).done)&&(o.push(a.value),o.length!==n);s=!0);}catch(e){c=!0,r=e}finally{try{if(!s&&null!=t.return&&(l=t.return(),Object(l)!==l))return}finally{if(c)throw r}}return o}}(e,n)||function(e,n){if(e){if("string"==typeof e)return l(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?l(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=Array(n);t<n;t++)a[t]=e[t];return a}var o="/plugins/signalk-edge-link",s=[{name:"serverType",label:"Operation Mode",description:"Select Server to receive data, or Client to send data",type:"select",options:[{value:"client",label:"Client Mode - Send Data"},{value:"server",label:"Server Mode - Receive Data"}],defaultValue:"client"},{name:"udpPort",label:"UDP Port",description:"UDP port for data transmission (must match on both ends)",type:"number",min:1024,max:65535,defaultValue:4446},{name:"secretKey",label:"Encryption Key",description:"32-character secret key (must match on both ends)",type:"password",minLength:32,maxLength:32},{name:"useMsgpack",label:"Use MessagePack",description:"Binary serialization for smaller payloads (must match on both ends)",type:"checkbox",defaultValue:!1},{name:"usePathDictionary",label:"Use Path Dictionary",description:"Encode paths as numeric IDs for bandwidth savings (must match on both ends)",type:"checkbox",defaultValue:!1},{name:"protocolVersion",label:"Protocol Version",description:"v1: encrypted UDP transmission. v2 adds: packet reliability (sequence tracking, ACK/NAK, retransmission), congestion control, connection bonding with failover, metrics/monitoring, and NAT keepalive. Must match on both ends.",type:"select",options:[{value:1,label:"v1 - Standard encrypted UDP"},{value:2,label:"v2 - Reliability, congestion control, bonding, metrics"}],defaultValue:1,numeric:!0}],c=[{name:"udpAddress",label:"Server Address",description:"IP address or hostname of the SignalK server",type:"text",defaultValue:"127.0.0.1"},{name:"helloMessageSender",label:"Heartbeat Interval (seconds)",description:"How often to send heartbeat messages",type:"number",min:10,max:3600,defaultValue:60},{name:"testAddress",label:"Connectivity Test Address",description:"Address to ping for network testing (e.g., 8.8.8.8)",type:"text",defaultValue:"127.0.0.1"},{name:"testPort",label:"Connectivity Test Port",description:"Port for connectivity test (80, 443, 53)",type:"number",min:1,max:65535,defaultValue:80},{name:"pingIntervalTime",label:"Check Interval (minutes)",description:"How often to test network connectivity",type:"number",min:.1,max:60,step:.1,defaultValue:1}],d=[{name:"enabled",label:"Enable Congestion Control",description:"Automatically adjust delta timer based on RTT and packet loss",type:"checkbox",defaultValue:!1},{name:"targetRTT",label:"Target RTT (ms)",description:"RTT threshold above which send rate is reduced",type:"number",min:50,max:2e3,defaultValue:200},{name:"minDeltaTimer",label:"Minimum Delta Timer (ms)",description:"Fastest allowed send interval",type:"number",min:50,max:1e3,defaultValue:100},{name:"maxDeltaTimer",label:"Maximum Delta Timer (ms)",description:"Slowest allowed send interval",type:"number",min:1e3,max:3e4,defaultValue:5e3}],m=[{value:"main-backup",label:"Main/Backup - Failover to backup when primary degrades"}],u=[{name:"address",label:"Server Address",type:"text",defaultValue:"127.0.0.1"},{name:"port",label:"UDP Port",type:"number",min:1024,max:65535},{name:"interface",label:"Bind Interface (optional)",description:"Network interface IP to bind to",type:"text"}],g=[{name:"rttThreshold",label:"RTT Threshold (ms)",description:"Failover when RTT exceeds this value",type:"number",min:100,max:5e3,defaultValue:500},{name:"lossThreshold",label:"Packet Loss Threshold",description:"Failover when loss exceeds this ratio (0.0 - 1.0)",type:"number",min:.01,max:.5,step:.01,defaultValue:.1},{name:"healthCheckInterval",label:"Health Check Interval (ms)",description:"How often to check link health",type:"number",min:500,max:1e4,defaultValue:1e3},{name:"failbackDelay",label:"Failback Delay (ms)",description:"Wait time before switching back to primary after recovery",type:"number",min:5e3,max:3e5,defaultValue:3e4}];function p(e){var n=e.field,t=e.value,a=e.onChange,i="field-"+n.name;return"checkbox"===n.type?r().createElement("div",{className:"form-group",key:n.name},r().createElement("label",null,r().createElement("input",{id:i,type:"checkbox",checked:!!t,onChange:function(e){return a(n.name,e.target.checked)}})," ",n.label),n.description&&r().createElement("p",{className:"field-description"},n.description)):"select"===n.type?r().createElement("div",{className:"form-group",key:n.name},r().createElement("label",{htmlFor:i},n.label),r().createElement("select",{id:i,className:"form-control",value:null!=t?t:n.defaultValue||"",onChange:function(e){var t=e.target.value;a(n.name,n.numeric?Number(t):t)}},n.options.map(function(e){return r().createElement("option",{key:e.value,value:e.value},e.label)})),n.description&&r().createElement("p",{className:"field-description"},n.description)):r().createElement("div",{className:"form-group",key:n.name},r().createElement("label",{htmlFor:i},n.label),r().createElement("input",{id:i,className:"form-control",type:n.type,value:null!=t?t:"",min:n.min,max:n.max,step:n.step,minLength:n.minLength,maxLength:n.maxLength,onChange:function(e){var t=e.target.value;a(n.name,"number"===n.type?""===t?"":Number(t):t)}}),n.description&&r().createElement("p",{className:"field-description"},n.description))}function f(e){var n=e.title,t=e.description,a=e.fields,i=e.data,l=e.onChange;return r().createElement("fieldset",{className:"field-group"},r().createElement("legend",null,n),t&&r().createElement("p",{className:"field-description"},t),a.map(function(e){return r().createElement(p,{key:e.name,field:e,value:i?i[e.name]:void 0,onChange:l})}))}const b=function(){var e=i((0,a.useState)({}),2),n=e[0],t=e[1],l=i((0,a.useState)(!0),2),b=l[0],h=l[1],y=i((0,a.useState)(null),2),v=y[0],k=y[1],E=i((0,a.useState)(null),2),x=E[0],C=E[1],w="server"!==n.serverType;(0,a.useEffect)(function(){var e=!1;return fetch(o+"/plugin-config").then(function(e){if(!e.ok)throw new Error("Failed to load: "+e.statusText);return e.json()}).then(function(n){!e&&n.success&&n.configuration&&t(n.configuration)}).catch(function(n){e||k(n.message)}).finally(function(){e||h(!1)}),function(){e=!0}},[]);var T=(0,a.useCallback)(function(e,n){t(function(t){var a=Object.assign({},t);return a[e]=n,a}),C(null)},[]),S=(0,a.useCallback)(function(e,n,a){t(function(t){var r=Object.assign({},t);return r[e]=Object.assign({},t[e]),r[e][n]=a,r}),C(null)},[]),P=(0,a.useCallback)(function(e,n,a,r){t(function(t){var i=Object.assign({},t);return i[e]=Object.assign({},t[e]),i[e][n]=Object.assign({},(t[e]||{})[n]),i[e][n][a]=r,i}),C(null)},[]),V=(0,a.useCallback)(function(e){e.preventDefault(),C({type:"saving",message:"Saving..."});var t=Object.assign({},n);"server"===t.serverType&&(delete t.udpAddress,delete t.helloMessageSender,delete t.testAddress,delete t.testPort,delete t.pingIntervalTime,delete t.congestionControl,delete t.bonding),fetch(o+"/plugin-config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){return e.json().then(function(n){if(!e.ok||!n.success)throw new Error(n.error||"Failed to save");C({type:"success",message:n.message||"Configuration saved. Plugin restarting..."})})}).catch(function(e){C({type:"error",message:e.message})})},[n]);if(b)return r().createElement("div",{style:{padding:"20px",textAlign:"center"}},"Loading configuration...");if(v)return r().createElement("div",{style:{padding:"20px",color:"#dc3545"}},r().createElement("h4",null,"Error Loading Configuration"),r().createElement("p",null,v));var N=x&&"success"===x.type?"#d4edda":x&&"error"===x.type?"#f8d7da":"#fff3cd",D=x&&"success"===x.type?"#155724":x&&"error"===x.type?"#721c24":"#856404",A=x&&"success"===x.type?"#c3e6cb":x&&"error"===x.type?"#f5c6cb":"#ffeeba";return r().createElement("div",{className:"signalk-edge-link-config"},x&&r().createElement("div",{style:{padding:"10px 15px",marginBottom:"15px",borderRadius:"4px",backgroundColor:N,color:D,border:"1px solid "+A}},x.message),r().createElement("form",{onSubmit:V},r().createElement("h3",null,"SignalK Edge Link"),r().createElement("p",{className:"field-description"},"Configure encrypted UDP data transmission between SignalK units"),s.map(function(e){return r().createElement(p,{key:e.name,field:e,value:n[e.name],onChange:T})}),w&&c.map(function(e){return r().createElement(p,{key:e.name,field:e,value:n[e.name],onChange:T})}),w&&r().createElement(f,{title:"Dynamic Congestion Control (v2 only)",description:"Requires Protocol v2. AIMD algorithm to dynamically adjust send rate based on network conditions",fields:d,data:n.congestionControl,onChange:function(e,n){S("congestionControl",e,n)}}),w&&r().createElement("fieldset",{className:"field-group"},r().createElement("legend",null,"Connection Bonding (v2 only)"),r().createElement("p",{className:"field-description"},"Requires Protocol v2. Dual-link bonding with automatic failover between primary and backup connections"),r().createElement("div",{className:"form-group"},r().createElement("label",null,r().createElement("input",{type:"checkbox",checked:!(!n.bonding||!n.bonding.enabled),onChange:function(e){S("bonding","enabled",e.target.checked)}})," ","Enable Connection Bonding"),r().createElement("p",{className:"field-description"},"Enable dual-link bonding with automatic failover")),r().createElement("div",{className:"form-group"},r().createElement("label",{htmlFor:"field-bonding-mode"},"Bonding Mode"),r().createElement("select",{id:"field-bonding-mode",className:"form-control",value:n.bonding&&n.bonding.mode?n.bonding.mode:"main-backup",onChange:function(e){S("bonding","mode",e.target.value)}},m.map(function(e){return r().createElement("option",{key:e.value,value:e.value},e.label)}))),r().createElement(f,{title:"Primary Link",description:"Primary connection (e.g., LTE modem)",fields:u.map(function(e){return Object.assign({},e,{defaultValue:"port"===e.name?4446:e.defaultValue})}),data:n.bonding?n.bonding.primary:void 0,onChange:function(e,n){P("bonding","primary",e,n)}}),r().createElement(f,{title:"Backup Link",description:"Backup connection (e.g., Starlink, satellite)",fields:u.map(function(e){return Object.assign({},e,{defaultValue:"port"===e.name?4447:e.defaultValue})}),data:n.bonding?n.bonding.backup:void 0,onChange:function(e,n){P("bonding","backup",e,n)}}),r().createElement(f,{title:"Failover Thresholds",description:"Configure when failover is triggered",fields:g,data:n.bonding?n.bonding.failover:void 0,onChange:function(e,n){P("bonding","failover",e,n)}})),r().createElement("button",{type:"submit",className:"btn btn-primary"},"Save Configuration")),r().createElement("style",null,".signalk-edge-link-config {  width: 100%;}.signalk-edge-link-config h3 {  margin-top: 0;}.signalk-edge-link-config .form-group {  margin-bottom: 1rem;}.signalk-edge-link-config label {  font-weight: 600;  margin-bottom: 0.25rem;  display: block;}.signalk-edge-link-config .field-description {  font-size: 0.85rem;  color: #666;  margin-top: 0.25rem;  margin-bottom: 0.5rem;}.signalk-edge-link-config input,.signalk-edge-link-config select {  width: 100%;  padding: 0.5rem;  border: 1px solid #ccc;  border-radius: 4px;  font-size: 1rem;  box-sizing: border-box;}.signalk-edge-link-config input[type='checkbox'] {  width: auto;  margin-right: 0.5rem;}.signalk-edge-link-config .field-group {  border: 1px solid #ddd;  border-radius: 4px;  padding: 1rem;  margin-bottom: 1rem;}.signalk-edge-link-config .field-group legend {  font-weight: 600;  font-size: 1.05rem;  padding: 0 0.5rem;}.signalk-edge-link-config .btn-primary {  background-color: #007bff;  border-color: #007bff;  color: white;  padding: 0.5rem 1rem;  border-radius: 4px;  cursor: pointer;  font-size: 1rem;  margin-top: 1rem;}.signalk-edge-link-config .btn-primary:hover {  background-color: #0069d9;  border-color: #0062cc;}"))}}}]);
//# sourceMappingURL=48.a82500376371c0deef3a.js.map